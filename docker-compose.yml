version: '3'

volumes:
  reports_data:
    driver: "local"
  django-data:
    driver: "local"

services:

  prospect:
    build: ./insight
    volumes:
      - "django-data:/database"
    environment:
      - "SECRET_KEY=6tdp62idf"

  lighthouse:
    build: ./lighthouse
    volumes:
    - "./lighthouse/lighthouse:/lighthouse"
    - "reports_data:/home/chrome/reports"
    command:
      - "/lighthouse/server.py"

  nginx:
    build:
      context: './nginx'
    volumes:
      - './nginx/config:/etc/nginx'
      - './nginx/static:/static'
      - "reports_data:/reports"
    depends_on:
      - 'lighthouse'
      - 'prospect'
    ports:
    - "80:80"
